{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.removeTrailingSlash = void 0;\n\nvar tslib_1 = require(\"tslib\");\n\nvar lodash_get_1 = tslib_1.__importDefault(require(\"lodash.get\"));\n\nvar Field_1 = require(\"../Field\");\n\nvar Resource_1 = require(\"../Resource\");\n\nvar getResources_1 = require(\"../utils/getResources\");\n\nvar removeTrailingSlash = function (url) {\n  if (url.endsWith(\"/\")) {\n    url = url.slice(0, -1);\n  }\n\n  return url;\n};\n\nexports.removeTrailingSlash = removeTrailingSlash;\n\nfunction default_1(response, entrypointUrl) {\n  var paths = getResources_1.getResources(response.paths);\n  var resources = paths.map(function (item) {\n    var name = item.replace(\"/\", \"\");\n    var url = exports.removeTrailingSlash(entrypointUrl) + item;\n    var firstMethod = Object.keys(response.paths[item])[0];\n    var responsePathItem = response.paths[item][firstMethod];\n\n    if (!responsePathItem.tags) {\n      throw new Error(); // @TODO\n    }\n\n    var title = responsePathItem.tags[0];\n\n    if (!response.definitions) {\n      throw new Error(); // @TODO\n    }\n\n    var definition = response.definitions[title];\n\n    if (!definition) {\n      throw new Error(); // @TODO\n    }\n\n    var properties = definition.properties;\n\n    if (!properties) {\n      throw new Error(); // @TODO\n    }\n\n    var fieldNames = Object.keys(properties);\n    var requiredFields = lodash_get_1.default(response, [\"definitions\", title, \"required\"], []);\n    var fields = fieldNames.map(function (fieldName) {\n      return new Field_1.Field(fieldName, {\n        id: null,\n        range: null,\n        reference: null,\n        required: !!requiredFields.find(function (value) {\n          return value === fieldName;\n        }),\n        description: lodash_get_1.default(properties[fieldName], \"description\", \"\")\n      });\n    });\n    return new Resource_1.Resource(name, url, {\n      id: null,\n      title: title,\n      fields: fields,\n      readableFields: fields,\n      writableFields: fields\n    });\n  });\n  return resources;\n}\n\nexports.default = default_1;","map":{"version":3,"sources":["../../src/swagger/handleJson.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.removeTrailingSlash = void 0;\nvar tslib_1 = require(\"tslib\");\nvar lodash_get_1 = tslib_1.__importDefault(require(\"lodash.get\"));\nvar Field_1 = require(\"../Field\");\nvar Resource_1 = require(\"../Resource\");\nvar getResources_1 = require(\"../utils/getResources\");\nvar removeTrailingSlash = function (url) {\n    if (url.endsWith(\"/\")) {\n        url = url.slice(0, -1);\n    }\n    return url;\n};\nexports.removeTrailingSlash = removeTrailingSlash;\nfunction default_1(response, entrypointUrl) {\n    var paths = getResources_1.getResources(response.paths);\n    var resources = paths.map(function (item) {\n        var name = item.replace(\"/\", \"\");\n        var url = exports.removeTrailingSlash(entrypointUrl) + item;\n        var firstMethod = Object.keys(response.paths[item])[0];\n        var responsePathItem = response.paths[item][firstMethod];\n        if (!responsePathItem.tags) {\n            throw new Error(); // @TODO\n        }\n        var title = responsePathItem.tags[0];\n        if (!response.definitions) {\n            throw new Error(); // @TODO\n        }\n        var definition = response.definitions[title];\n        if (!definition) {\n            throw new Error(); // @TODO\n        }\n        var properties = definition.properties;\n        if (!properties) {\n            throw new Error(); // @TODO\n        }\n        var fieldNames = Object.keys(properties);\n        var requiredFields = lodash_get_1.default(response, [\"definitions\", title, \"required\"], []);\n        var fields = fieldNames.map(function (fieldName) {\n            return new Field_1.Field(fieldName, {\n                id: null,\n                range: null,\n                reference: null,\n                required: !!requiredFields.find(function (value) { return value === fieldName; }),\n                description: lodash_get_1.default(properties[fieldName], \"description\", \"\"),\n            });\n        });\n        return new Resource_1.Resource(name, url, {\n            id: null,\n            title: title,\n            fields: fields,\n            readableFields: fields,\n            writableFields: fields,\n        });\n    });\n    return resources;\n}\nexports.default = default_1;\n//# sourceMappingURL=handleJson.js.map"]},"metadata":{},"sourceType":"script"}