{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.IntrospectedCreateGuesser = void 0;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactAdmin = require(\"react-admin\");\n\nvar _InputGuesser = _interopRequireDefault(require(\"./InputGuesser\"));\n\nvar _Introspecter = _interopRequireDefault(require(\"./Introspecter\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _getRequireWildcardCache(nodeInterop) {\n  if (typeof WeakMap !== \"function\") return null;\n  var cacheBabelInterop = new WeakMap();\n  var cacheNodeInterop = new WeakMap();\n  return (_getRequireWildcardCache = function (nodeInterop) {\n    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n  })(nodeInterop);\n}\n\nfunction _interopRequireWildcard(obj, nodeInterop) {\n  if (!nodeInterop && obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache(nodeInterop);\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nconst displayOverrideCode = (schema, fields) => {\n  if (process.env.NODE_ENV === 'production') return;\n  let code = 'If you want to override at least one input, paste this content in the <CreateGuesser> component of your resource:\\n\\n';\n  code += `const ${schema.title}Create = props => (\\n`;\n  code += `    <CreateGuesser {...props}>\\n`;\n  fields.forEach(field => {\n    code += `        <InputGuesser source={\"${field.name}\"} />\\n`;\n  });\n  code += `    </CreateGuesser>\\n`;\n  code += `);\\n`;\n  code += `\\n`;\n  code += `And don't forget update your <ResourceGuesser> component:\\n`;\n  code += `<ResourceGuesser name={\"${schema.name}\"} create={${schema.title}Create} />`;\n  console.info(code);\n};\n\nconst IntrospectedCreateGuesser = _ref => {\n  let {\n    fields,\n    readableFields,\n    writableFields,\n    schema,\n    schemaAnalyzer,\n    resource,\n    basePath,\n    onSuccess,\n    successMessage,\n    onFailure,\n    redirect: redirectTo = 'list',\n    initialValues,\n    validate,\n    toolbar,\n    margin,\n    variant,\n    submitOnEnter,\n    warnWhenUnsavedChanges,\n    sanitizeEmptyValues,\n    simpleFormComponent,\n    children,\n    ...props\n  } = _ref;\n  const [mutate] = (0, _reactAdmin.useMutation)();\n  const notify = (0, _reactAdmin.useNotify)();\n  const redirect = (0, _reactAdmin.useRedirect)();\n  let inputChildren = children;\n\n  if (!inputChildren) {\n    inputChildren = writableFields.map(field => /*#__PURE__*/_react.default.createElement(_InputGuesser.default, {\n      key: field.name,\n      source: field.name\n    }));\n    displayOverrideCode(schema, writableFields);\n  }\n\n  if (!Array.isArray(inputChildren)) {\n    inputChildren = [inputChildren];\n  }\n\n  const hasFileField = inputChildren.some(child => child.type === _reactAdmin.FileInput);\n  const save = (0, _react.useCallback)(async values => {\n    try {\n      const response = await mutate({\n        type: 'create',\n        resource: resource,\n        payload: {\n          data: { ...values,\n            extraInformation: {\n              hasFileField\n            }\n          }\n        }\n      }, {\n        returnPromise: true\n      });\n      const success = onSuccess ? onSuccess : _ref2 => {\n        let {\n          data: newRecord\n        } = _ref2;\n        notify(successMessage || 'ra.notification.created', 'info', {\n          smart_count: 1\n        });\n        redirect(redirectTo, basePath, newRecord.id, newRecord);\n      };\n      success(response);\n    } catch (error) {\n      const submissionErrors = schemaAnalyzer.getSubmissionErrors(error);\n      const failure = onFailure ? onFailure : error => {\n        let message = 'ra.notification.http_error';\n\n        if (!submissionErrors) {\n          message = typeof error === 'string' ? error : error.message || message;\n        }\n\n        notify(message, 'warning', {\n          _: typeof error === 'string' ? error : error && error.message ? error.message : undefined\n        });\n      };\n      failure(error);\n\n      if (submissionErrors) {\n        return submissionErrors;\n      }\n\n      return {};\n    }\n  }, [mutate, hasFileField, resource, onSuccess, successMessage, onFailure, notify, redirect, redirectTo, basePath, schemaAnalyzer]);\n  return /*#__PURE__*/_react.default.createElement(_reactAdmin.Create, _extends({\n    resource: resource,\n    basePath: basePath\n  }, props), /*#__PURE__*/_react.default.createElement(_reactAdmin.SimpleForm, {\n    save: save,\n    initialValues: initialValues,\n    validate: validate,\n    toolbar: toolbar,\n    margin: margin,\n    variant: variant,\n    submitOnEnter: submitOnEnter,\n    warnWhenUnsavedChanges: warnWhenUnsavedChanges,\n    sanitizeEmptyValues: sanitizeEmptyValues,\n    component: simpleFormComponent\n  }, inputChildren));\n};\n\nexports.IntrospectedCreateGuesser = IntrospectedCreateGuesser;\n\nconst CreateGuesser = props => /*#__PURE__*/_react.default.createElement(_Introspecter.default, _extends({\n  component: IntrospectedCreateGuesser\n}, props));\n\nCreateGuesser.propTypes = {\n  children: _propTypes.default.oneOfType([_propTypes.default.node, _propTypes.default.func]),\n  resource: _propTypes.default.string.isRequired\n};\nvar _default = CreateGuesser;\nexports.default = _default;","map":{"version":3,"sources":["C:/newproject/bookshop-api/myadmin/node_modules/@api-platform/admin/lib/CreateGuesser.js"],"names":["Object","defineProperty","exports","value","default","IntrospectedCreateGuesser","_react","_interopRequireWildcard","require","_propTypes","_interopRequireDefault","_reactAdmin","_InputGuesser","_Introspecter","obj","__esModule","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_extends","assign","target","i","arguments","length","source","apply","displayOverrideCode","schema","fields","process","env","NODE_ENV","code","title","forEach","field","name","console","info","readableFields","writableFields","schemaAnalyzer","resource","basePath","onSuccess","successMessage","onFailure","redirect","redirectTo","initialValues","validate","toolbar","margin","variant","submitOnEnter","warnWhenUnsavedChanges","sanitizeEmptyValues","simpleFormComponent","children","props","mutate","useMutation","notify","useNotify","useRedirect","inputChildren","map","createElement","Array","isArray","hasFileField","some","child","type","FileInput","save","useCallback","values","response","payload","data","extraInformation","returnPromise","success","newRecord","smart_count","id","error","submissionErrors","getSubmissionErrors","failure","message","_","undefined","Create","SimpleForm","component","CreateGuesser","propTypes","oneOfType","node","func","string","isRequired","_default"],"mappings":"AAAA;;AAEAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAC3CC,EAAAA,KAAK,EAAE;AADoC,CAA7C;AAGAD,OAAO,CAACE,OAAR,GAAkBF,OAAO,CAACG,yBAAR,GAAoC,KAAK,CAA3D;;AAEA,IAAIC,MAAM,GAAGC,uBAAuB,CAACC,OAAO,CAAC,OAAD,CAAR,CAApC;;AAEA,IAAIC,UAAU,GAAGC,sBAAsB,CAACF,OAAO,CAAC,YAAD,CAAR,CAAvC;;AAEA,IAAIG,WAAW,GAAGH,OAAO,CAAC,aAAD,CAAzB;;AAEA,IAAII,aAAa,GAAGF,sBAAsB,CAACF,OAAO,CAAC,gBAAD,CAAR,CAA1C;;AAEA,IAAIK,aAAa,GAAGH,sBAAsB,CAACF,OAAO,CAAC,gBAAD,CAAR,CAA1C;;AAEA,SAASE,sBAAT,CAAgCI,GAAhC,EAAqC;AAAE,SAAOA,GAAG,IAAIA,GAAG,CAACC,UAAX,GAAwBD,GAAxB,GAA8B;AAAEV,IAAAA,OAAO,EAAEU;AAAX,GAArC;AAAwD;;AAE/F,SAASE,wBAAT,CAAkCC,WAAlC,EAA+C;AAAE,MAAI,OAAOC,OAAP,KAAmB,UAAvB,EAAmC,OAAO,IAAP;AAAa,MAAIC,iBAAiB,GAAG,IAAID,OAAJ,EAAxB;AAAuC,MAAIE,gBAAgB,GAAG,IAAIF,OAAJ,EAAvB;AAAsC,SAAO,CAACF,wBAAwB,GAAG,UAAUC,WAAV,EAAuB;AAAE,WAAOA,WAAW,GAAGG,gBAAH,GAAsBD,iBAAxC;AAA4D,GAAjH,EAAmHF,WAAnH,CAAP;AAAyI;;AAEvT,SAASV,uBAAT,CAAiCO,GAAjC,EAAsCG,WAAtC,EAAmD;AAAE,MAAI,CAACA,WAAD,IAAgBH,GAAhB,IAAuBA,GAAG,CAACC,UAA/B,EAA2C;AAAE,WAAOD,GAAP;AAAa;;AAAC,MAAIA,GAAG,KAAK,IAAR,IAAgB,OAAOA,GAAP,KAAe,QAAf,IAA2B,OAAOA,GAAP,KAAe,UAA9D,EAA0E;AAAE,WAAO;AAAEV,MAAAA,OAAO,EAAEU;AAAX,KAAP;AAA0B;;AAAC,MAAIO,KAAK,GAAGL,wBAAwB,CAACC,WAAD,CAApC;;AAAmD,MAAII,KAAK,IAAIA,KAAK,CAACC,GAAN,CAAUR,GAAV,CAAb,EAA6B;AAAE,WAAOO,KAAK,CAACE,GAAN,CAAUT,GAAV,CAAP;AAAwB;;AAAC,MAAIU,MAAM,GAAG,EAAb;AAAiB,MAAIC,qBAAqB,GAAGzB,MAAM,CAACC,cAAP,IAAyBD,MAAM,CAAC0B,wBAA5D;;AAAsF,OAAK,IAAIC,GAAT,IAAgBb,GAAhB,EAAqB;AAAE,QAAIa,GAAG,KAAK,SAAR,IAAqB3B,MAAM,CAAC4B,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqChB,GAArC,EAA0Ca,GAA1C,CAAzB,EAAyE;AAAE,UAAII,IAAI,GAAGN,qBAAqB,GAAGzB,MAAM,CAAC0B,wBAAP,CAAgCZ,GAAhC,EAAqCa,GAArC,CAAH,GAA+C,IAA/E;;AAAqF,UAAII,IAAI,KAAKA,IAAI,CAACR,GAAL,IAAYQ,IAAI,CAACC,GAAtB,CAAR,EAAoC;AAAEhC,QAAAA,MAAM,CAACC,cAAP,CAAsBuB,MAAtB,EAA8BG,GAA9B,EAAmCI,IAAnC;AAA2C,OAAjF,MAAuF;AAAEP,QAAAA,MAAM,CAACG,GAAD,CAAN,GAAcb,GAAG,CAACa,GAAD,CAAjB;AAAyB;AAAE;AAAE;;AAACH,EAAAA,MAAM,CAACpB,OAAP,GAAiBU,GAAjB;;AAAsB,MAAIO,KAAJ,EAAW;AAAEA,IAAAA,KAAK,CAACW,GAAN,CAAUlB,GAAV,EAAeU,MAAf;AAAyB;;AAAC,SAAOA,MAAP;AAAgB;;AAEpyB,SAASS,QAAT,GAAoB;AAAEA,EAAAA,QAAQ,GAAGjC,MAAM,CAACkC,MAAP,IAAiB,UAAUC,MAAV,EAAkB;AAAE,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,SAAS,CAACC,MAA9B,EAAsCF,CAAC,EAAvC,EAA2C;AAAE,UAAIG,MAAM,GAAGF,SAAS,CAACD,CAAD,CAAtB;;AAA2B,WAAK,IAAIT,GAAT,IAAgBY,MAAhB,EAAwB;AAAE,YAAIvC,MAAM,CAAC4B,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCS,MAArC,EAA6CZ,GAA7C,CAAJ,EAAuD;AAAEQ,UAAAA,MAAM,CAACR,GAAD,CAAN,GAAcY,MAAM,CAACZ,GAAD,CAApB;AAA4B;AAAE;AAAE;;AAAC,WAAOQ,MAAP;AAAgB,GAA5P;;AAA8P,SAAOF,QAAQ,CAACO,KAAT,CAAe,IAAf,EAAqBH,SAArB,CAAP;AAAyC;;AAE7T,MAAMI,mBAAmB,GAAG,CAACC,MAAD,EAASC,MAAT,KAAoB;AAC9C,MAAIC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAA7B,EAA2C;AAC3C,MAAIC,IAAI,GAAG,uHAAX;AACAA,EAAAA,IAAI,IAAK,SAAQL,MAAM,CAACM,KAAM,uBAA9B;AACAD,EAAAA,IAAI,IAAK,kCAAT;AACAJ,EAAAA,MAAM,CAACM,OAAP,CAAeC,KAAK,IAAI;AACtBH,IAAAA,IAAI,IAAK,kCAAiCG,KAAK,CAACC,IAAK,SAArD;AACD,GAFD;AAGAJ,EAAAA,IAAI,IAAK,wBAAT;AACAA,EAAAA,IAAI,IAAK,MAAT;AACAA,EAAAA,IAAI,IAAK,IAAT;AACAA,EAAAA,IAAI,IAAK,6DAAT;AACAA,EAAAA,IAAI,IAAK,2BAA0BL,MAAM,CAACS,IAAK,cAAaT,MAAM,CAACM,KAAM,YAAzE;AACAI,EAAAA,OAAO,CAACC,IAAR,CAAaN,IAAb;AACD,CAdD;;AAgBA,MAAM1C,yBAAyB,GAAG,QAuB5B;AAAA,MAvB6B;AACjCsC,IAAAA,MADiC;AAEjCW,IAAAA,cAFiC;AAGjCC,IAAAA,cAHiC;AAIjCb,IAAAA,MAJiC;AAKjCc,IAAAA,cALiC;AAMjCC,IAAAA,QANiC;AAOjCC,IAAAA,QAPiC;AAQjCC,IAAAA,SARiC;AASjCC,IAAAA,cATiC;AAUjCC,IAAAA,SAViC;AAWjCC,IAAAA,QAAQ,EAAEC,UAAU,GAAG,MAXU;AAYjCC,IAAAA,aAZiC;AAajCC,IAAAA,QAbiC;AAcjCC,IAAAA,OAdiC;AAejCC,IAAAA,MAfiC;AAgBjCC,IAAAA,OAhBiC;AAiBjCC,IAAAA,aAjBiC;AAkBjCC,IAAAA,sBAlBiC;AAmBjCC,IAAAA,mBAnBiC;AAoBjCC,IAAAA,mBApBiC;AAqBjCC,IAAAA,QArBiC;AAsBjC,OAAGC;AAtB8B,GAuB7B;AACJ,QAAM,CAACC,MAAD,IAAW,CAAC,GAAGhE,WAAW,CAACiE,WAAhB,GAAjB;AACA,QAAMC,MAAM,GAAG,CAAC,GAAGlE,WAAW,CAACmE,SAAhB,GAAf;AACA,QAAMhB,QAAQ,GAAG,CAAC,GAAGnD,WAAW,CAACoE,WAAhB,GAAjB;AACA,MAAIC,aAAa,GAAGP,QAApB;;AAEA,MAAI,CAACO,aAAL,EAAoB;AAClBA,IAAAA,aAAa,GAAGzB,cAAc,CAAC0B,GAAf,CAAmB/B,KAAK,IAAI,aAAa5C,MAAM,CAACF,OAAP,CAAe8E,aAAf,CAA6BtE,aAAa,CAACR,OAA3C,EAAoD;AAC3GuB,MAAAA,GAAG,EAAEuB,KAAK,CAACC,IADgG;AAE3GZ,MAAAA,MAAM,EAAEW,KAAK,CAACC;AAF6F,KAApD,CAAzC,CAAhB;AAIAV,IAAAA,mBAAmB,CAACC,MAAD,EAASa,cAAT,CAAnB;AACD;;AAED,MAAI,CAAC4B,KAAK,CAACC,OAAN,CAAcJ,aAAd,CAAL,EAAmC;AACjCA,IAAAA,aAAa,GAAG,CAACA,aAAD,CAAhB;AACD;;AAED,QAAMK,YAAY,GAAGL,aAAa,CAACM,IAAd,CAAmBC,KAAK,IAAIA,KAAK,CAACC,IAAN,KAAe7E,WAAW,CAAC8E,SAAvD,CAArB;AACA,QAAMC,IAAI,GAAG,CAAC,GAAGpF,MAAM,CAACqF,WAAX,EAAwB,MAAMC,MAAN,IAAgB;AACnD,QAAI;AACF,YAAMC,QAAQ,GAAG,MAAMlB,MAAM,CAAC;AAC5Ba,QAAAA,IAAI,EAAE,QADsB;AAE5B/B,QAAAA,QAAQ,EAAEA,QAFkB;AAG5BqC,QAAAA,OAAO,EAAE;AACPC,UAAAA,IAAI,EAAE,EAAE,GAAGH,MAAL;AACJI,YAAAA,gBAAgB,EAAE;AAChBX,cAAAA;AADgB;AADd;AADC;AAHmB,OAAD,EAU1B;AACDY,QAAAA,aAAa,EAAE;AADd,OAV0B,CAA7B;AAaA,YAAMC,OAAO,GAAGvC,SAAS,GAAGA,SAAH,GAAe,SAElC;AAAA,YAFmC;AACvCoC,UAAAA,IAAI,EAAEI;AADiC,SAEnC;AACJtB,QAAAA,MAAM,CAACjB,cAAc,IAAI,yBAAnB,EAA8C,MAA9C,EAAsD;AAC1DwC,UAAAA,WAAW,EAAE;AAD6C,SAAtD,CAAN;AAGAtC,QAAAA,QAAQ,CAACC,UAAD,EAAaL,QAAb,EAAuByC,SAAS,CAACE,EAAjC,EAAqCF,SAArC,CAAR;AACD,OAPD;AAQAD,MAAAA,OAAO,CAACL,QAAD,CAAP;AACD,KAvBD,CAuBE,OAAOS,KAAP,EAAc;AACd,YAAMC,gBAAgB,GAAG/C,cAAc,CAACgD,mBAAf,CAAmCF,KAAnC,CAAzB;AACA,YAAMG,OAAO,GAAG5C,SAAS,GAAGA,SAAH,GAAeyC,KAAK,IAAI;AAC/C,YAAII,OAAO,GAAG,4BAAd;;AAEA,YAAI,CAACH,gBAAL,EAAuB;AACrBG,UAAAA,OAAO,GAAG,OAAOJ,KAAP,KAAiB,QAAjB,GAA4BA,KAA5B,GAAoCA,KAAK,CAACI,OAAN,IAAiBA,OAA/D;AACD;;AAED7B,QAAAA,MAAM,CAAC6B,OAAD,EAAU,SAAV,EAAqB;AACzBC,UAAAA,CAAC,EAAE,OAAOL,KAAP,KAAiB,QAAjB,GAA4BA,KAA5B,GAAoCA,KAAK,IAAIA,KAAK,CAACI,OAAf,GAAyBJ,KAAK,CAACI,OAA/B,GAAyCE;AADvD,SAArB,CAAN;AAGD,OAVD;AAWAH,MAAAA,OAAO,CAACH,KAAD,CAAP;;AAEA,UAAIC,gBAAJ,EAAsB;AACpB,eAAOA,gBAAP;AACD;;AAED,aAAO,EAAP;AACD;AACF,GA7CY,EA6CV,CAAC5B,MAAD,EAASU,YAAT,EAAuB5B,QAAvB,EAAiCE,SAAjC,EAA4CC,cAA5C,EAA4DC,SAA5D,EAAuEgB,MAAvE,EAA+Ef,QAA/E,EAAyFC,UAAzF,EAAqGL,QAArG,EAA+GF,cAA/G,CA7CU,CAAb;AA8CA,SAAO,aAAalD,MAAM,CAACF,OAAP,CAAe8E,aAAf,CAA6BvE,WAAW,CAACkG,MAAzC,EAAiD5E,QAAQ,CAAC;AAC5EwB,IAAAA,QAAQ,EAAEA,QADkE;AAE5EC,IAAAA,QAAQ,EAAEA;AAFkE,GAAD,EAG1EgB,KAH0E,CAAzD,EAGT,aAAapE,MAAM,CAACF,OAAP,CAAe8E,aAAf,CAA6BvE,WAAW,CAACmG,UAAzC,EAAqD;AAC3EpB,IAAAA,IAAI,EAAEA,IADqE;AAE3E1B,IAAAA,aAAa,EAAEA,aAF4D;AAG3EC,IAAAA,QAAQ,EAAEA,QAHiE;AAI3EC,IAAAA,OAAO,EAAEA,OAJkE;AAK3EC,IAAAA,MAAM,EAAEA,MALmE;AAM3EC,IAAAA,OAAO,EAAEA,OANkE;AAO3EC,IAAAA,aAAa,EAAEA,aAP4D;AAQ3EC,IAAAA,sBAAsB,EAAEA,sBARmD;AAS3EC,IAAAA,mBAAmB,EAAEA,mBATsD;AAU3EwC,IAAAA,SAAS,EAAEvC;AAVgE,GAArD,EAWrBQ,aAXqB,CAHJ,CAApB;AAeD,CAvGD;;AAyGA9E,OAAO,CAACG,yBAAR,GAAoCA,yBAApC;;AAEA,MAAM2G,aAAa,GAAGtC,KAAK,IAAI,aAAapE,MAAM,CAACF,OAAP,CAAe8E,aAAf,CAA6BrE,aAAa,CAACT,OAA3C,EAAoD6B,QAAQ,CAAC;AACvG8E,EAAAA,SAAS,EAAE1G;AAD4F,CAAD,EAErGqE,KAFqG,CAA5D,CAA5C;;AAIAsC,aAAa,CAACC,SAAd,GAA0B;AACxBxC,EAAAA,QAAQ,EAAEhE,UAAU,CAACL,OAAX,CAAmB8G,SAAnB,CAA6B,CAACzG,UAAU,CAACL,OAAX,CAAmB+G,IAApB,EAA0B1G,UAAU,CAACL,OAAX,CAAmBgH,IAA7C,CAA7B,CADc;AAExB3D,EAAAA,QAAQ,EAAEhD,UAAU,CAACL,OAAX,CAAmBiH,MAAnB,CAA0BC;AAFZ,CAA1B;AAIA,IAAIC,QAAQ,GAAGP,aAAf;AACA9G,OAAO,CAACE,OAAR,GAAkBmH,QAAlB","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.IntrospectedCreateGuesser = void 0;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactAdmin = require(\"react-admin\");\n\nvar _InputGuesser = _interopRequireDefault(require(\"./InputGuesser\"));\n\nvar _Introspecter = _interopRequireDefault(require(\"./Introspecter\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nconst displayOverrideCode = (schema, fields) => {\n  if (process.env.NODE_ENV === 'production') return;\n  let code = 'If you want to override at least one input, paste this content in the <CreateGuesser> component of your resource:\\n\\n';\n  code += `const ${schema.title}Create = props => (\\n`;\n  code += `    <CreateGuesser {...props}>\\n`;\n  fields.forEach(field => {\n    code += `        <InputGuesser source={\"${field.name}\"} />\\n`;\n  });\n  code += `    </CreateGuesser>\\n`;\n  code += `);\\n`;\n  code += `\\n`;\n  code += `And don't forget update your <ResourceGuesser> component:\\n`;\n  code += `<ResourceGuesser name={\"${schema.name}\"} create={${schema.title}Create} />`;\n  console.info(code);\n};\n\nconst IntrospectedCreateGuesser = ({\n  fields,\n  readableFields,\n  writableFields,\n  schema,\n  schemaAnalyzer,\n  resource,\n  basePath,\n  onSuccess,\n  successMessage,\n  onFailure,\n  redirect: redirectTo = 'list',\n  initialValues,\n  validate,\n  toolbar,\n  margin,\n  variant,\n  submitOnEnter,\n  warnWhenUnsavedChanges,\n  sanitizeEmptyValues,\n  simpleFormComponent,\n  children,\n  ...props\n}) => {\n  const [mutate] = (0, _reactAdmin.useMutation)();\n  const notify = (0, _reactAdmin.useNotify)();\n  const redirect = (0, _reactAdmin.useRedirect)();\n  let inputChildren = children;\n\n  if (!inputChildren) {\n    inputChildren = writableFields.map(field => /*#__PURE__*/_react.default.createElement(_InputGuesser.default, {\n      key: field.name,\n      source: field.name\n    }));\n    displayOverrideCode(schema, writableFields);\n  }\n\n  if (!Array.isArray(inputChildren)) {\n    inputChildren = [inputChildren];\n  }\n\n  const hasFileField = inputChildren.some(child => child.type === _reactAdmin.FileInput);\n  const save = (0, _react.useCallback)(async values => {\n    try {\n      const response = await mutate({\n        type: 'create',\n        resource: resource,\n        payload: {\n          data: { ...values,\n            extraInformation: {\n              hasFileField\n            }\n          }\n        }\n      }, {\n        returnPromise: true\n      });\n      const success = onSuccess ? onSuccess : ({\n        data: newRecord\n      }) => {\n        notify(successMessage || 'ra.notification.created', 'info', {\n          smart_count: 1\n        });\n        redirect(redirectTo, basePath, newRecord.id, newRecord);\n      };\n      success(response);\n    } catch (error) {\n      const submissionErrors = schemaAnalyzer.getSubmissionErrors(error);\n      const failure = onFailure ? onFailure : error => {\n        let message = 'ra.notification.http_error';\n\n        if (!submissionErrors) {\n          message = typeof error === 'string' ? error : error.message || message;\n        }\n\n        notify(message, 'warning', {\n          _: typeof error === 'string' ? error : error && error.message ? error.message : undefined\n        });\n      };\n      failure(error);\n\n      if (submissionErrors) {\n        return submissionErrors;\n      }\n\n      return {};\n    }\n  }, [mutate, hasFileField, resource, onSuccess, successMessage, onFailure, notify, redirect, redirectTo, basePath, schemaAnalyzer]);\n  return /*#__PURE__*/_react.default.createElement(_reactAdmin.Create, _extends({\n    resource: resource,\n    basePath: basePath\n  }, props), /*#__PURE__*/_react.default.createElement(_reactAdmin.SimpleForm, {\n    save: save,\n    initialValues: initialValues,\n    validate: validate,\n    toolbar: toolbar,\n    margin: margin,\n    variant: variant,\n    submitOnEnter: submitOnEnter,\n    warnWhenUnsavedChanges: warnWhenUnsavedChanges,\n    sanitizeEmptyValues: sanitizeEmptyValues,\n    component: simpleFormComponent\n  }, inputChildren));\n};\n\nexports.IntrospectedCreateGuesser = IntrospectedCreateGuesser;\n\nconst CreateGuesser = props => /*#__PURE__*/_react.default.createElement(_Introspecter.default, _extends({\n  component: IntrospectedCreateGuesser\n}, props));\n\nCreateGuesser.propTypes = {\n  children: _propTypes.default.oneOfType([_propTypes.default.node, _propTypes.default.func]),\n  resource: _propTypes.default.string.isRequired\n};\nvar _default = CreateGuesser;\nexports.default = _default;"]},"metadata":{},"sourceType":"script"}